"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{455:function(e,r,s){s.d(r,{Z:function(){return C}});var t=s(5893),l=s(7294),a=s(6693),i=s(2667),d=s(5675),n=s.n(d),c=s(5810),o=s(9990),u=s(7536),h=s(4100),m=s(1163);let x=e=>{let{item:r,isNew:s,handleCourse:d}=e,[x,p]=(0,l.useState)(r.published),[f,g]=(0,l.useState)(!1),{register:j,handleSubmit:v,formState:{errors:b}}=(0,u.cI)(),y=(0,m.useRouter)(),{CourseMethods:w,choosedLvl1:N}=(0,o.T)(),C=e=>{w.updateFunction(r.id,e.name,e.grade,1,x,r.orden),g(!1)},k=()=>{p(!x),w.updateFunction(r.id,r.name,r.grade,1,!x,r.orden)},S=async()=>{let e=await (0,h.pl)("את בטוחה שאת רוצה למחוק?","אם תלחצי כן לא תוכלי לשחזר את הקובץ והוא ימחק באופן סופי");e&&w.removeFunction(r.id,1)};return(0,t.jsxs)("div",{className:"rounded-md relative ".concat(f?"editMode":""," relative ").concat(s?"bg-white":"bg-green/10"," myShadowCard cursor-pointer ").concat(N==r.id?"activeShadow":""),style:{height:"300px",width:"300px"},onClick:()=>y.push("/admin/tableOfContents/".concat(r.id)),children:[f&&(0,t.jsx)("span",{className:"absolute m-4 text-white",onClick:()=>g(!1),children:"X"}),(0,t.jsx)("div",{className:"text-center h-full flex justify-center items-center",children:(0,t.jsx)("div",{children:s?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"bg-gray p-8 rounded-full",onClick:()=>d(),children:(0,t.jsx)(n(),{src:"/images/+.svg",width:19,height:15,alt:"+"})})}):(0,t.jsx)(t.Fragment,{children:f?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("form",{onSubmit:v(C),children:[(0,t.jsx)("input",{...j("grade"),type:"text",placeholder:"כיתה",className:"px-2 rounded-md py-2 m-1 text-black"}),(0,t.jsx)("input",{...j("name"),type:"text",placeholder:"שם הקורס",className:"px-2 rounded-md py-2 m-1 text-black"}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{className:"bg-primary text-white mt-2 px-4 py-2 rounded-lg",type:"submit",children:"שמירה"})})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Z,{children:r.grade}),(0,t.jsx)(i.Z,{className:"text-xl",children:r.name})]})})})}),s?(0,t.jsx)("div",{className:"bg-gray absolute rounded-b-md bottom-0 w-full flex text-center items-center justify-center py-1 h-16"}):(0,t.jsx)("div",{className:"bg-green/30 absolute rounded-b-md bottom-0 w-full flex text-center items-center justify-center py-1 h-16",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 w-full mr-5 mt-2 mb-2",children:[(0,t.jsxs)("div",{className:"col-span-8 flex gap-4",children:[(0,t.jsx)("div",{className:"bg-white rounded-full cursor-pointer flex justify-center p-4",onClick:()=>g(!f),children:(0,t.jsx)(n(),{src:"/images/draw.svg",width:15,height:15,alt:"draw"})}),(0,t.jsx)("div",{className:"bg-white rounded-full  cursor-pointer flex justify-center p-4",onClick:()=>S(),children:(0,t.jsx)(n(),{src:"/images/trash.svg",width:19,height:15,alt:"draw"})})]}),(0,t.jsx)("div",{className:"col-span-4 items-center flex justify-center",children:(0,t.jsx)(c.Z,{onChange:k,checked:x})})]})})]})},p=e=>{let{placeholder:r,...s}=e;return(0,t.jsxs)("div",{className:"flex border border-black/50 px-2 rounded-md",children:[(0,t.jsx)("input",{placeholder:r,...s,className:"hover:border-none"}),(0,t.jsx)(n(),{src:"/images/search.svg",width:15,height:15,alt:"search",priority:!0})]})},f=e=>{let{item:r,isExercise:s,level:a,clearArray:i}=e,d=(0,m.useRouter)(),[c,x]=(0,l.useState)(!1),{CourseMethods:p,choosedLvl1:f,choosedLvl2:g,choosedLvl3:j,choosedLvl4:v}=(0,o.T)(),{register:b,handleSubmit:y,watch:w,formState:{errors:N}}=(0,u.cI)(),C=e=>{p.updateFunction(r.id,e.name,r.grade,r.level,r.published,r.orden),x(!1),i()},k=async()=>{let e=await (0,h.pl)("את בטוחה שאת רוצה למחוק?","אם תלחצי כן לא תוכלי לשחזר את הקובץ והוא ימחק באופן סופי");e&&p.removeFunction(r.id,r.level),i()},{query:S}=d,T=e=>{S.first&&2===a?d.push("/admin/tableOfContents/".concat(S.first,"/").concat(e)):S.first&&S.second&&3===a?d.push("/admin/tableOfContents/".concat(S.first,"/").concat(S.second,"/").concat(e)):S.first&&S.second&&S.third&&4===a?d.push("/admin/tableOfContents/".concat(S.first,"/").concat(S.second,"/").concat(S.third,"/").concat(e)):S.first&&!S.second&&S.third&&S.fourth&&5===a?d.push("/admin/tableOfContents/".concat(S.first,"/").concat(S.second,"/").concat(S.third,"/").concat(S.fourth,"/").concat(e)):S.first&&!S.second&&S.third&&S.fourth&&S.fifth&&d.push("/admin/tableOfContents/".concat(S.first,"/").concat(S.second,"/").concat(S.third,"/").concat(S.fourth,"/").concat(S.fifth))};return(0,t.jsxs)("div",{className:"border-t border-gray cardHover ".concat((()=>{if(2===a){if(g==r.id)return!0}else if(3===a){if(j==r.id)return!0}else if(4===a){if(v==r.id)return!0}else if(5!=a)return!1})()?"clickedCard":""),children:[(0,t.jsxs)("div",{className:"flex py-2 m-auto px-4 ",children:[(0,t.jsx)("div",{className:"w-full flex items-center cursor-pointer",onClick:()=>T(r.id),children:(0,t.jsx)("p",{children:r.name})}),(0,t.jsxs)("div",{className:"flex gap-2 ",children:[s&&(0,t.jsx)("div",{className:" border border-black rounded-full flex justify-center w-12 h-12 hover:bg-white",children:(0,t.jsx)(n(),{src:"/images/eye.svg",width:30,height:30,priority:!0,alt:"trash",className:" cursor-pointer rounded-lg p-1",onClick:()=>d.push("/admin/createModule/".concat(r.id))})}),(0,t.jsx)("div",{className:"border border-black rounded-full flex justify-center w-12 h-12 hover:bg-white",children:(0,t.jsx)(n(),{src:"/images/draw.svg",width:25,height:2,priority:!0,alt:"draw",className:" cursor-pointer rounded-lg p-1",onClick:()=>x(!c)})}),(0,t.jsx)("div",{className:"border border-black rounded-full flex justify-center w-12 h-12 hover:bg-white",children:(0,t.jsx)(n(),{src:"/images/trash.svg",width:25,height:25,priority:!0,alt:"trash",className:" cursor-pointer rounded-lg p-1",onClick:()=>k()})})]})]}),c&&(0,t.jsxs)("form",{className:"flex pt-4 m-auto px-4 py-4",children:[(0,t.jsx)("div",{className:"w-full flex items-center",children:(0,t.jsx)("input",{...b("name"),type:"text",placeholder:"עריכה",className:"border border-gray p-2 rounded-md"})}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)("div",{className:" rounded-full flex justify-center w-12 h-12",style:{backgroundColor:"#31B0F2"},children:(0,t.jsx)(n(),{src:"/images/vWhite.svg",width:25,height:25,priority:!0,alt:"draw",className:" cursor-pointer rounded-lg p-1",onClick:y(C)})}),(0,t.jsx)("div",{className:" rounded-full flex justify-center w-12 h-12",style:{backgroundColor:"rgba(49, 176, 242, 0.3)"},children:(0,t.jsx)(n(),{src:"/images/xBlue.svg",width:25,height:25,priority:!0,alt:"trash",className:" cursor-pointer rounded-lg p-1",onClick:()=>x(!1)})})]})]})]})};var g=s(5948),j=s(3136);let v=e=>{let{data:r,title:s,level:a,parentId:i,isExercise:d}=e,{CourseMethods:c}=(0,o.T)(),[h,m]=(0,l.useState)(!1),[x,v]=(0,l.useState)(""),[b,y]=(0,l.useState)([]),[w,N]=(0,l.useState)(!1),[C,k]=(0,l.useState)([]),{register:S,handleSubmit:T}=(0,u.cI)(),E=e=>{c.createFunction(e.name,a,i),m(!1),I()},F=e=>{if(!e.destination)return;let[s]=r.splice(e.source.index,1);if(r.splice(e.destination.index,0,s),b.length>0){let e=r.map((e,r)=>({...e,orden:r+1}));y(e)}else{let e=r.map((e,r)=>({...e,orden:r+1}));k(e),setTimeout(()=>{e.map(e=>{c.silentUpdate(e.id,e.name,e.grade,e.level,e.published,e.orden)})},500)}},I=()=>{k([])};return(0,l.useEffect)(()=>{x?y((C.length>0?C:r).filter(e=>e.name.includes(x))):y([])},[r,x,C]),(0,t.jsx)(g.Z5,{onDragEnd:F,children:(0,t.jsx)("div",{className:"border border-black/20 rounded-md",children:(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("div",{className:"flex w-full border-b-2 border-black/10 py-2",children:(0,t.jsx)("div",{className:"flex w-full m-auto px-4",children:(0,t.jsx)("p",{children:s})})}),(0,t.jsxs)("div",{className:"flex py-4 m-auto px-4",children:[(0,t.jsx)("div",{style:{backgroundColor:"#31B0F2"},className:"w-11 h-10 rounded-lg text-center items-center justify-center cursor-pointer  flex",onClick:()=>m(!h),children:(0,t.jsx)(n(),{src:"/images/+.svg",width:20,height:20,alt:"add",priority:!0})}),(0,t.jsx)("div",{className:"w-full flex justify-end",children:(0,t.jsx)(p,{placeholder:"חיפוש",value:x,onChange:e=>v(e.target.value)})})]}),h&&(d?(0,t.jsxs)("div",{className:"m-auto px-4",children:[(0,t.jsx)("div",{className:"flex py-2",children:(0,t.jsx)("p",{children:"שם התרגיל"})}),(0,t.jsxs)("form",{onSubmit:T(E),className:"grid grid-cols-8 gap-4",children:[(0,t.jsx)("div",{className:"col-span-12",children:(0,t.jsx)("input",{...S("name"),className:"border border-primary/30 rounded-md w-full px-2 py-2",placeholder:"שם"})}),(0,t.jsx)("div",{className:"col-span-12",children:(0,t.jsx)("button",{className:"bg-green/40  w-full rounded-md text-white  hover:bg-green/70 py-2",style:{backgroundColor:"#31B0F2"},children:"בניית תרגיל"})})]})]}):(0,t.jsxs)("div",{className:"m-auto px-4",children:[(0,t.jsx)("div",{className:"flex",children:(0,t.jsxs)("p",{children:["שם ה",s]})}),(0,t.jsxs)("form",{onSubmit:T(E),className:"grid grid-cols-8 gap-4",children:[(0,t.jsx)("div",{className:"col-span-6",children:(0,t.jsx)("input",{...S("name"),className:"border border-primary/30 rounded-md w-full px-2 py-2",placeholder:"שם"})}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsx)("button",{className:"bg-green/40  w-full rounded-md text-white  hover:bg-green/70 py-2",style:{backgroundColor:"#31B0F2"},children:"שמירה"})})]})]})),w?(0,t.jsx)("div",{className:"myCenter p-12",children:(0,t.jsx)(j.gy,{height:"80",width:"80",color:"#31B0F2",ariaLabel:"tail-spin-loading",radius:"1",wrapperStyle:{},wrapperClass:"",visible:w})}):(0,t.jsx)("div",{className:"overflow-auto py-2",children:(0,t.jsx)(g.bK,{droppableId:"droppable",children:e=>(0,t.jsxs)("div",{...e.droppableProps,ref:e.innerRef,children:[(C.length>0?b.length>0?b:C:b.length>0?b:r).map((e,r)=>(0,t.jsx)(g._l,{draggableId:e.id.toString(),index:r,children:s=>(0,t.jsx)("div",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,children:(0,t.jsx)(f,{item:e,isExercise:d,level:a,clearArray:I},r)})},e.id)),e.placeholder]})})})]})})})},b=()=>{let{CourseMethods:e,lvl1:r,lvl2:s,lvl3:l,lvl4:a,choosedLvl1:i,choosedLvl2:d,choosedLvl3:n,choosedLvl4:c,isLoadingLvl1:u,loadingLvl2:h,loadingLvl3:m,loadingLvl4:x}=(0,o.T)();return(0,t.jsx)(t.Fragment,{children:u||h||m||x?(0,t.jsx)("div",{className:"myCenter",children:(0,t.jsx)(j.g4,{height:"80",width:"80",radius:"9",color:"#31B0F2",ariaLabel:"three-dots-loading",wrapperStyle:{},visible:!0})}):(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 px-12 pb-12",children:[(null==r?void 0:r.children)&&(0,t.jsx)(v,{title:"פרקים",data:null==r?void 0:r.children,level:2,parentId:i,isExercise:!1}),(null==s?void 0:s.children)&&(0,t.jsx)(v,{title:"יחידות",data:s.children,level:3,parentId:d,isExercise:!1}),(null==l?void 0:l.children)&&(0,t.jsx)(v,{title:"נושאים",data:l.children,level:4,parentId:n,isExercise:!1}),(null==a?void 0:a.children)&&(0,t.jsx)(v,{title:"תרגילים",data:a.children,level:5,parentId:c,isExercise:!0})]})})};var y=s(1559),w=s(521);let N=()=>{let[e,r]=(0,l.useState)(!1),{register:s,handleSubmit:a,formState:{errors:d}}=(0,u.cI)(),{courses:n,CourseMethods:c,choosedLvl1:h,choosedCourse:p,lvl1:f,lvl2:g,lvl3:j,lvl4:v}=(0,o.T)(),N=()=>c.createFunction("",1,null);(0,m.useRouter)();let C=e=>{};return(0,t.jsx)(y.Z,{title:"קורסים",children:(0,t.jsx)(w.Z,{children:(0,t.jsxs)("div",{className:"h-full",style:{backgroundColor:"#F0FBFF"},children:[(0,t.jsxs)("div",{className:"mr-12 mb-10",children:[(0,t.jsx)(i.Z,{className:"pt-12 pb-4",children:"תוכן העניינים"}),(0,t.jsxs)("div",{className:"gap-8 flex overflow-x-auto w-full",children:[(0,t.jsx)("div",{children:(0,t.jsx)(x,{item:{id:0,color:"",level:1,published:!0,name:"",grade:"",orden:0,image:""},isNew:!0,handleCourse:N})}),null==n?void 0:n.map((e,r)=>(0,t.jsx)("div",{onClick:()=>C(e),className:"flex-shrink-0 ",children:(0,t.jsx)(x,{item:e,isNew:!1,handleCourse:N},r)},r))]})]}),(0,t.jsxs)("div",{className:"bg-white",style:{minHeight:"45%"},children:[(0,t.jsx)("div",{className:"px-12 py-6",children:(0,t.jsxs)("p",{children:["עריכת קורס: ",null==f?void 0:f.name," ",(null==g?void 0:g.name)&&"/"," ",null==g?void 0:g.name," ",(null==j?void 0:j.name)&&"/"," ",null==j?void 0:j.name," ",(null==v?void 0:v.name)&&"/"," ",null==v?void 0:v.name,"  "]})}),h&&(0,t.jsx)(b,{})]})]})})})};var C=N},9990:function(e,r,s){s.d(r,{N:function(){return u},T:function(){return o}});var t=s(5893),l=s(7294),a=s(6154);let i={async create(e){let r=await (0,a.Z)({url:"/courses",method:"POST",data:e});return r.data},async getCoursesLvl1(){let e=await (0,a.Z)({url:"/courses",method:"GET"});return e.data},async getChildrenById(e){let r=await (0,a.Z)({url:"/courses/parent/".concat(e),method:"GET"});return r.data},async getRecursiveChildren(e){let r=await (0,a.Z)({url:"/courses/recursiveId/".concat(e),method:"GET"});return r.data},async update(e,r){let s=await (0,a.Z)({url:"/courses/".concat(e),method:"PUT",data:r});return s.data},async remove(e){let r=await (0,a.Z)({url:"/courses/".concat(e),method:"DELETE"});return r.data}};var d=s(7837),n=s(1163);let c=(0,l.createContext)(null),o=()=>{let e=(0,l.useContext)(c);if(!e)throw Error('Can not run without "CourseProvider"');return e},u=e=>{let[r,s]=(0,l.useState)(null),[a,o]=(0,l.useState)(null),[u,h]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[p,f]=(0,l.useState)(null),[g,j]=(0,l.useState)(null),v=(0,n.useRouter)(),{data:b,isLoading:y,isError:w,refetch:N}=(0,d.a)(["get courses"],()=>i.getCoursesLvl1(),{staleTime:0,cacheTime:0}),{data:C,isLoading:k,isError:S,refetch:T}=(0,d.a)(["get course by id",a],()=>null===a?null:i.getChildrenById(a),{staleTime:0,cacheTime:0}),{data:E,isLoading:F,isError:I,refetch:Z}=(0,d.a)(["get course by id",u],()=>null===u?null:i.getChildrenById(u),{staleTime:0,cacheTime:0}),{data:B,isLoading:L,isError:O,refetch:P}=(0,d.a)(["get course by id",m],()=>null===m?null:i.getChildrenById(m),{staleTime:0,cacheTime:0}),{data:R,isLoading:q,isError:_,refetch:G}=(0,d.a)(["get course by id",p],()=>null===p?null:i.getChildrenById(p),{staleTime:0,cacheTime:0}),H=e=>{1==e?T():2==e?Z():3==e?P():4==e&&G(),0==e&&T()},M=()=>{T(),Z(),P(),G()},D=async(e,r,s,t,l,a)=>{await i.update(e,{name:r,grade:s,published:l,orden:a}),H(t-1),N()},U=async(e,r,s,t,l,a)=>{await i.update(e,{name:r,grade:s,published:l,orden:a})},A=async(e,r)=>{await i.remove(e),M(),N()},K=async(e,r,s)=>{await i.create({name:e,level:r,totalChildren:1,parent:s,published:!0}),null==s&&N(),H(r-1)};return(0,l.useEffect)(()=>{(()=>{let{query:e}=v;!e.first||e.second||e.third||e.fourth||e.fifth?!e.first||!e.second||e.third||e.fourth||e.fifth?e.first&&e.second&&e.third&&!e.fourth&&!e.fifth?(o(e.first),h(e.second),x(e.third)):e.first&&e.second&&e.third&&e.fourth&&!e.fifth&&(o(e.first),h(e.second),x(e.third),f(e.fourth)):(o(e.first),h(e.second)):o(e.first)})()},[v.query.first,v.query.second,v.query.third,v.query.fourth,v.query.fifth,v]),(0,t.jsx)(c.Provider,{value:{courses:b,CourseMethods:{setChoosedLvl1:o,setChoosedLvl2:h,setChoosedLvl3:x,setChoosedLvl4:f,setChoosedLvl5:j,refetchLvl1:T,refetchLvl2:Z,refetchLvl3:P,refetchLvl4:G,updateFunction:D,silentUpdate:U,removeFunction:A,createFunction:K,setChoosedCourse:s},lvl1:C,choosedLvl1:a,lvl2:E,choosedLvl2:u,lvl3:B,choosedLvl3:m,lvl4:R,choosedLvl4:p,choosedCourse:r,isLoadingLvl1:k,loadingLvl2:F,loadingLvl3:L,loadingLvl4:q},...e})}}}]);