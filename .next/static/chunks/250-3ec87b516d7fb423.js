"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[250],{8250:function(e,l,t){t.d(l,{Z:function(){return Z}});var o=t(5893),s=t(1559),c=t(7294),n=t(521),a=t(2760),i=t(6010);let r=e=>{let{children:l,className:t,...s}=e;return(0,o.jsx)("button",{...s,className:(0,i.Z)("rounded-x1 font-medium px-10 py-2 shadow",t),children:l})};var d=t(2667),u=t(1930);let x=e=>{let{value:l,register:t,col:s,row:n,setValue:a}=e,{isOnlineXml:i}=(0,u.t)();return(0,c.useEffect)(()=>{a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].orden"),n),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].module_type"),"text"),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].collectionAnswers"),[]),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].isFullText"),!1)},[s,n,a]),(0,o.jsx)("th",{className:"pt-4",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{contentEditable:!0,dangerouslySetInnerHTML:{__html:l},className:"text-right pr-2"}),(0,o.jsx)("input",{type:"hidden",disable:!0,...t("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].collectionValues"),{value:[{value:l}]})})]})})},m=e=>{let{answer:l,placeholder:t,register:s,col:n,row:a,setValue:i,isFullText:r}=e;return(0,c.useEffect)(()=>{i("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].orden"),a),i("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].module_type"),"input"),i("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].isFullText"),r),i("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].collectionValues"),[])},[n,a,i,r]),(0,o.jsxs)("th",{className:"bg-white pt-4",children:[(0,o.jsx)("input",{type:"text",disabled:!0,placeholder:t,className:"w-28 px-4 h-full py-2 border border-gray rounded-md",...s("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].collectionAnswers[0].value"),{value:l})}),(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("input",{type:"checkbox",...s("collectionsRows[".concat(n,"].collectionRow[").concat(a,"].isFullText"),r)}),(0,o.jsx)("span",{className:"text-sm pr-2",children:"בכתיב מלא"})]})]})};var p=t(7536);let h=e=>{let{placeholder:l,options:t,answer:s,col:n,row:i,register:r,setValue:d,control:u}=e,x=null==t?void 0:t.map(e=>({value:e.value,label:e.value})),m=e=>e?x.find(l=>l.value.trim()==e):{value:s,label:s};return(0,c.useEffect)(()=>{d("collectionsRows[".concat(n,"].collectionRow[").concat(i,"].orden"),i),d("collectionsRows[".concat(n,"].collectionRow[").concat(i,"].collectionAnswers[0].value"),s),d("collectionsRows[".concat(n,"].collectionRow[").concat(i,"].collectionValues"),t),d("collectionsRows[".concat(n,"].collectionRow[").concat(i,"].module_type"),"selectbox"),d("collectionsRows[".concat(n,"].collectionRow[").concat(i,"].isFullText"),!1)},[s,n,t,i,d]),(0,o.jsx)("th",{className:"bg-white pt-4",children:(0,o.jsx)(p.Qr,{control:u,name:"collectionsRows[".concat(n,"].collectionRow[").concat(i,"].collectionAnswers[0].value"),rules:{required:"צריך לבחור את התשובה"},render:e=>{let{field:{onChange:t,value:s},fieldState:{error:c}}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.ZP,{placeholder:l,options:x,value:m(s),onChange:e=>t(null==e?void 0:e.value),className:"ml-4 mr-4"}),c&&(0,o.jsx)("div",{style:{color:"red"},children:c.message})]})}})})},v=e=>{let{value:l,register:t,col:s,row:n,setValue:a}=e,{isOnlineXml:i}=(0,u.t)();return(0,c.useEffect)(()=>{a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].orden"),n),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].module_type"),"textarea"),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].collectionAnswers"),[]),a("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].isFullText"),!1)},[s,n,a]),(0,o.jsx)("th",{className:"bg-white pt-4",children:(0,o.jsx)("textarea",{disabled:!0,type:"hidden",...t("collectionsRows[".concat(s,"].collectionRow[").concat(n,"].collectionValues[0].value"),{value:l}),style:{width:"200px",height:"50px",resize:"none"}})})};var w=t(5390),j=t(5675),y=t.n(j),g=t(7326);let f=e=>{let{exercises:l,register:t,setValue:s,tableType:n,orden:a}=e,{isOnlineXml:i}=(0,u.t)(),[r,d]=(0,c.useState)(!1),[x,m]=(0,c.useState)(!1),[p,h]=(0,c.useState)(),[v,w]=(0,c.useState)(),[j,y]=(0,c.useState)(!1),[f,b]=(0,c.useState)(!1),N=async e=>{var l;let t=null===(l=e.target.files)||void 0===l?void 0:l[0];if(t){let e=await g.s.uploadPdf(t);s("".concat("exercises"==n?"pdf":"collectionsRows[".concat(a,"].pdf")),e.path),h(e.path)}},R=()=>{let e=null==l?void 0:l.pdf;f&&(e=p),(null==l?void 0:l.pdf)&&window.open("http://localhost:4000/".concat(e),"_blank","noopener")},k=()=>{let e=null==l?void 0:l.youtube_link;j&&(e=v),e&&window.open(e,"_blank","noopener")},C=()=>{(null==l?void 0:l.id)&&p&&n&&g.s.updatePdf(null==l?void 0:l.id,{pdf:p,tableType:n}),b(!0),d(!1)},_=()=>{(null==l?void 0:l.id)&&v&&n&&g.s.updateLink(null==l?void 0:l.id,{link:v,tableType:n}),y(!0),m(!1)};return(0,o.jsx)("div",{className:"mb-12",children:(0,o.jsx)("form",{children:i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"m-2",children:[(0,o.jsxs)("div",{className:" items-center flex",children:[(0,o.jsx)("span",{className:"".concat(f||((null==l?void 0:l.pdf)?"bg-primary text-white":" bg-gray text-black"),"  p-2 rounded-md material-symbols-outlined fill cursor-pointer"),onClick:R,children:"picture_as_pdf"}),(0,o.jsx)("span",{className:"pr-4",children:(null==l?void 0:l.pdf)?(0,o.jsx)(o.Fragment,{children:"לינק ל PDF"}):(0,o.jsx)(o.Fragment,{children:"לא קיים קובץ PDF"})}),(0,o.jsx)("button",{className:"bg-primary text-white rounded-lg py-1 px-2 mr-12 cursor-pointer",onClick:e=>{e.preventDefault(),d(!r)},children:"עדכן"})]}),f&&(0,o.jsx)("div",{className:"text-green/60",children:"עודכן בהצלחה!"}),r&&(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("input",{type:"file",placeholder:"עדכן קובץ PDF",className:"border border-gray m-2 px-2 rounded-md",onChange:N}),(0,o.jsx)("button",{className:"bg-primary text-white px-2 py-1 rounded-lg",onClick:e=>{e.preventDefault(),C()},children:"שמור"})]})]}),(0,o.jsxs)("div",{className:"m-2",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"".concat(j||((null==l?void 0:l.youtube_link)?"bg-primary text-white":" bg-gray text-black"),"  p-2 rounded-md material-symbols-outlined fill cursor-pointer"),onClick:k,children:"youtube_activity"}),(0,o.jsx)("span",{className:"pr-4",children:(null==l?void 0:l.youtube_link)?(0,o.jsx)(o.Fragment,{children:"לינק לסרטון"}):(0,o.jsx)(o.Fragment,{children:"לא קיים לינק לסרטון"})}),(0,o.jsx)("button",{className:"bg-primary text-white rounded-lg py-1 px-2 mr-12 cursor-pointer",onClick:e=>{e.preventDefault(),m(!x)},children:"עדכן"})]}),j&&(0,o.jsx)("div",{className:"text-green/60",children:"עודכן בהצלחה!"}),x&&(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("input",{type:"text",placeholder:"עדכן לינק לסרטון",className:"border border-gray m-2 px-2 rounded-md",value:v,onChange:e=>w(e.target.value)}),(0,o.jsx)("button",{className:"bg-primary text-white px-2 py-1 rounded-lg",onClick:e=>{e.preventDefault(),_()},children:"שמור"})]})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,o.jsx)("span",{className:"".concat(j||((null==l?void 0:l.youtube_link)?"bg-primary text-white":" bg-gray text-black"),"  p-2 rounded-md material-symbols-outlined fill cursor-pointer"),onClick:k,children:"youtube_activity"}),(0,o.jsx)("input",{placeholder:"לינק ליוטיוב",className:"w-full border border-gray rounded-md px-2",...t("".concat("exercises"==n?"youtube_link":"collectionsRows[".concat(a,"].youtube_link")))})]}),(0,o.jsxs)("div",{className:"flex items-center gap-4 mg-2",children:[(0,o.jsx)("span",{className:"".concat(f||((null==l?void 0:l.pdf)?"bg-primary text-white":" bg-gray text-black"),"  p-2 rounded-md material-symbols-outlined fill cursor-pointer"),onClick:R,children:"picture_as_pdf"}),(0,o.jsx)("input",{type:"file",onChange:N,className:"w-full border border-gray rounded-md px-2"})]})]})})})},b=e=>{let{exercises:l,register:t,orden:s,setValue:n,control:a}=e,[i,r]=(0,c.useState)(!1),{isOnlineXml:p}=(0,u.t)();(0,c.useEffect)(()=>{n("collectionsRows[".concat(s,"].orden"),s),n("collectionsRows[".concat(s,"].youtube_link"),null==l?void 0:l.youtube_link),n("collectionsRows[".concat(s,"].pdf"),null==l?void 0:l.pdf)},[s,n,null==l?void 0:l.pdf,null==l?void 0:l.youtube_link]);let j=()=>{r(!i)},g=()=>{r(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("th",{className:"bg-primary text-white pt-5",children:s}),l.collectionRow.map((e,l)=>"text"==e.module_type?(0,o.jsx)(x,{value:e.collectionValues[0].value,register:t,col:s,row:e.orden,setValue:n},l):"input"==e.module_type?(0,o.jsx)(m,{answer:e.collectionAnswers.length>0?e.collectionAnswers[0].value:"",placeholder:e.placeholder||"",register:t,col:s,row:e.orden,setValue:n,isFullText:e.isFullText},l):"selectbox"==e.module_type?(0,o.jsx)(h,{placeholder:e.placeholder||"",options:e.collectionValues,answer:e.collectionAnswers.length>0?e.collectionAnswers[0].value:"",register:t,col:s,row:e.orden,setValue:n,control:a},l):"textarea"==e.module_type?(0,o.jsx)(v,{value:e.collectionValues[0].value,register:t,col:s,row:e.orden,setValue:n},l):void 0),(0,o.jsx)("th",{className:"bg-white",children:(0,o.jsx)("div",{className:"flex gap-6 items-center justify-center pt-4",children:(0,o.jsx)("div",{className:"bg-primary p-2 rounded-lg cursor-pointer",onClick:()=>j(),children:(0,o.jsx)(y(),{src:"/images/settings.svg",alt:"settings",width:25,height:25})})})}),(0,o.jsx)(w.Z,{anchor:"left",isOpen:i,onClose:g,children:(0,o.jsx)("div",{style:{width:"700px"},className:"myCenter",children:(0,o.jsxs)("div",{className:"m-10 w-full",children:[(0,o.jsx)("div",{className:"text-center",children:(0,o.jsxs)(d.Z,{children:["שורה מספר: ",null==l?void 0:l.orden," "]})}),(0,o.jsx)(f,{exercises:l,register:t,setValue:n,tableType:"exercises_rows",orden:s})]})})})]})};var N=t(1163),R=t(6693);let k=e=>{let{item:l,register:t,setValue:s,index:n}=e,{isOnlineXml:a}=(0,u.t)();return(0,c.useEffect)(()=>{s("collectionsCols[".concat(l.orden,"].orden"),n)},[l.orden,n,s]),(0,o.jsx)("div",{className:"p-1",children:(0,o.jsx)("input",{disabled:!0,className:"w-36 rounded-md  text-white bg-primary text-center",...t("collectionsCols[".concat(l.orden,"].title"),{value:l.title})})})};var C=t(4100),_=t(3136);let S=e=>e.length>10?e.slice(0,10)+"...":e,F=[{value:1,label:"מודול ראשון"}],E=()=>{var e,l,t;let[i,x]=(0,c.useState)(),[m,h]=(0,c.useState)(null),[v,j]=(0,c.useState)(),{ExerciseMethods:g,exercises:E,isOnlineXml:Z,loading:T}=(0,u.t)(),V=(0,N.useRouter)(),P=V.query.moduleId,{register:D,handleSubmit:A,watch:I,formState:{errors:q},setValue:L,control:O}=(0,p.cI)(),X=e=>{console.log("data",e),g.createMoudle(e)},M=e=>{e.target.files&&e.target.files.length>0&&h(e.target.files[0])},Q=async e=>{if(e.preventDefault(),console.log("isEmptySelect",i),i){if(m)try{await (0,C.pl)("האם תרצו להריץ את הקובץ?","")&&g.uploadXml(m)}catch(e){console.error("Error:",e)}else console.error("No file selected")}else(0,C.QS)("אנא בחרו מודל רצוי","")};(0,c.useEffect)(()=>{E&&(L("title",null==E?void 0:E.title),L("description",null==E?void 0:E.description),L("description2",null==E?void 0:E.description2),L("module",null==E?void 0:E.module),L("courseId",P),L("youtube_link",null==E?void 0:E.youtube_link),L("pdf",null==E?void 0:E.pdf))},[E,P,L]);let[H,U]=(0,c.useState)(!1),W=()=>{U(!H)},z=()=>{U(!1)},G=e=>e?F.find(l=>l.value===e):{value:null==E?void 0:E.module,label:null==E?void 0:E.module};return(0,o.jsx)(s.Z,{title:"יצירת מודול",children:(0,o.jsxs)(n.Z,{children:[(0,o.jsxs)("div",{className:"mr-12",children:[(0,o.jsx)(d.Z,{children:null==E?void 0:E.title}),(0,o.jsx)(R.Z,{children:null==E?void 0:E.description}),(null==E?void 0:E.title)&&(0,o.jsx)("div",{className:"border-b border-solid border-2 border-gray-400"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 py-10 px-2 relative",children:[(0,o.jsx)(p.Qr,{control:O,name:"module",rules:{required:"צריך לבחור מודול"},render:e=>{let{field:{onChange:l,value:t},fieldState:{error:s}}=e;return x(t),(0,o.jsxs)(o.Fragment,{children:[console.log("value",t),(0,o.jsx)(a.ZP,{placeholder:"בחירת מודול",options:F,value:G(t),onChange:e=>l(null==e?void 0:e.value),className:"w-96"}),s&&(0,o.jsx)("div",{style:{color:"red",position:"absolute",bottom:"10px",paddingRight:"15px"},children:s.message})]})}}),(0,o.jsxs)("form",{onSubmit:Q,encType:"multipart/form-data",className:"justify-end items-end flex gap-12",children:[(null==E?void 0:E.title)&&P&&Z&&(0,o.jsx)(r,{className:"bg-red text-white rounded-md",onClick:()=>g.deleteModule(P),children:"מחיקה"}),!Z&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("label",{htmlFor:"fileInput",className:"w-56 bg-primary flex items-center justify-center px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-md cursor-pointer",children:"בחר קובץ"}),(0,o.jsx)("input",{id:"fileInput",type:"file",onChange:M,className:"hidden"}),m&&(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(r,{className:"bg-primary text-white rounded-md ",children:"העלה"}),(0,o.jsx)("div",{className:"absolute ",children:S(m.name)})]}),m&&(0,o.jsx)(r,{className:"bg-green text-white rounded-md",onClick:A(X),children:"שמור"})]}),(0,o.jsx)("div",{className:"bg-primary p-2 rounded-lg",onClick:()=>W(),children:(0,o.jsx)(y(),{src:"/images/settings.svg",alt:"settings",width:25,height:25})})]})]})]}),T?(0,o.jsx)("div",{className:"myCenter",style:{minHeight:"50vh"},children:(0,o.jsx)(_.iT,{height:80,width:80,color:"#4fa94d",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"#4fa94d",strokeWidth:2,strokeWidthSecondary:2})}):(0,o.jsx)("form",{onSubmit:A(X),className:"mr-12",children:(0,o.jsx)("table",{className:"w-full",children:(0,o.jsxs)("tbody",{className:"",children:[(0,o.jsxs)("tr",{className:"heading bg-primary",children:[(0,o.jsx)("div",{className:"text-center justify-center text-white"}),null==E?void 0:null===(e=E.collectionsCols)||void 0===e?void 0:e.map((e,l)=>(0,o.jsx)("th",{className:"",children:(0,o.jsx)(k,{item:e,index:l+1,register:D,setValue:L})},l)),(0,o.jsx)("div",{className:"text-center justify-center text-white "})]}),null==E?void 0:null===(l=E.collectionsRows)||void 0===l?void 0:l.map((e,l)=>(0,o.jsx)("tr",{children:(0,o.jsx)(b,{exercises:e,register:D,orden:e.orden,setValue:L,control:O},l)},l))]})})}),(0,o.jsx)(w.Z,{anchor:"left",isOpen:H,onClose:z,children:(0,o.jsx)("div",{style:{width:"700px"},className:"myCenter",children:(0,o.jsxs)("div",{className:"m-10 w-full",children:[(0,o.jsx)("div",{className:"text-center",children:(0,o.jsx)(d.Z,{children:null==E?void 0:E.title})}),(0,o.jsx)("div",{children:(0,o.jsx)(R.Z,{children:null==E?void 0:E.description})}),(0,o.jsx)("div",{className:"pt-12",children:(0,o.jsx)("textarea",{value:null!==(t=null==E?void 0:E.description2)&&void 0!==t?t:"",className:"w-full h-96"})}),(0,o.jsx)(f,{exercises:E,register:D,setValue:L,tableType:"exercises"})]})})})]})})};var Z=E},1930:function(e,l,t){t.d(l,{A:function(){return d},t:function(){return r}});var o=t(5893),s=t(7294),c=t(7326),n=t(1163),a=t(4100);let i=(0,s.createContext)(null),r=()=>{let e=(0,s.useContext)(i);if(!e)throw Error('Can not run without "ExerciseProvider"');return e},d=e=>{let[l,t]=(0,s.useState)(),[r,d]=(0,s.useState)(!1),[u,x]=(0,s.useState)(),[m,p]=(0,s.useState)(!1),h=(0,n.useRouter)(),v=h.query.moduleId,w=async e=>{d(!0);try{let l=await c.s.getOne(e);l&&(x(l),p(!0))}catch(e){console.log("error",e)}finally{d(!1)}},j=async e=>{d(!0);try{let l=await c.s.parseXlFile(e);x(l),p(!1)}catch(e){console.log("error",e),(0,a.Cf)("שגיאה בלפרסס את המודול","XL אינו תקין")}finally{d(!1)}},y=async e=>{d(!0);try{await c.s.create(e),setTimeout(()=>{w(v),(0,a.KO)("תרגיל נשמר בהצלחה!",""),d(!1)},2e3)}catch(e){console.log("error",e)}finally{}},g=async e=>{let l=await (0,a.pl)("האם תרצו למחוק את המודול הזה?","");if(l){d(!0),x(void 0),p(!1);try{await c.s.delete(e),await w(v)}catch(e){console.log("error",e)}finally{d(!1)}}};return(0,s.useEffect)(()=>{let e=h.query.moduleId;w(e)},[h.query.moduleId]),(0,o.jsx)(i.Provider,{value:{exercises:u,ExerciseMethods:{setId:t,uploadXml:j,createMoudle:y,deleteModule:g},loading:r,isOnlineXml:m},...e})}},7326:function(e,l,t){t.d(l,{s:function(){return s}});var o=t(6154);let s={async create(e){let l=await (0,o.Z)({url:"/exercises",method:"POST",data:e});return l.data},async getOne(e){let l=await (0,o.Z)({url:"/exercises/".concat(e),method:"GET"});return l.data},async parseXlFile(e){let l=new FormData;l.append("file",e);let t=await o.Z.post("/courses/uploadXl",l);return t.data},async delete(e){let l=await (0,o.Z)({url:"/exercises/".concat(e),method:"DELETE"});return l.data},async uploadPdf(e){let l=new FormData;l.append("file",e);let t=await o.Z.post("/exercises/pdf",l);return t.data},async updatePdf(e,l){let t=await (0,o.Z)({url:"/exercises/pdf/".concat(e),method:"PUT",data:l});return t.data},async updateLink(e,l){let t=await (0,o.Z)({url:"/exercises/linkvideo/".concat(e),method:"PUT",data:l});return t.data}}}}]);